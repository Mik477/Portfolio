import{e as Ae}from"../chunks/BEXN-trC.js";import{p as Te}from"../chunks/CEdCo-yv.js";import{a as Me,s as re}from"../chunks/DY8pyCGo.js";import{i as we,s as De,a as Pe}from"../chunks/Cqwhy9oZ.js";import{p as $e,o as Ie,aj as se,ak as xe,f as W,al as Ce,b as je,am as j,an as Z,c as L,a as Le,G as n,O as K,ar as V,w as Ne,a5 as N,v as f,ao as Oe,as as Ye,aq as P,au as We,r as k,ap as O,at as ne}from"../chunks/DQxZm1d5.js";import{i as le}from"../chunks/CAJOqlX4.js";import{e as qe}from"../chunks/BePSwt02.js";import{s as ce}from"../chunks/BdnGTaVf.js";import{p as Be}from"../chunks/cRCCMNoe.js";import{p as He}from"../chunks/BprMU9w6.js";import{g as S,M as Re}from"../chunks/BWkSOB07.js";import{s as ue}from"../chunks/DNt4T4Uq.js";import{s as Xe,p as Ue,a as ie}from"../chunks/D0H63XxL.js";import{r as Y}from"../chunks/D5ZgqvWD.js";const Ze=({params:q})=>{const E=Te.find(A=>A.slug===q.slug);if(!E)throw Ae(404,"Project not found");return{project:E}},dt=Object.freeze(Object.defineProperty({__proto__:null,load:Ze},Symbol.toStringTag,{value:"Module"}));var Ke=W('<meta name="description"/>'),Ve=W('<div class="subpage-background-image svelte-gygcht"></div>'),ze=W('<section class="subpage-fullscreen-section svelte-gygcht"><!> <div class="subpage-content-overlay svelte-gygcht"><h2 class="svelte-gygcht"> </h2> <p class="svelte-gygcht"> </p></div></section>'),Fe=W("<div></div> <!>",1);function ft(q,E){$e(E,!1);const A=()=>re(Y,"$renderProfile",z),B=()=>re(T,"$isContentLoaded",z),[z,de]=Me();let fe=Be(E,"data",8);const{project:c}=fe(),H=`project-assets-${c.slug}`,T=Ne(!1);let p=K([]),$=K([]),_=[],M=[],w=[],b=0,R=K(0),g=!1,I=0;const F=200,x=1.1;let h=!1,u=null,X=0,U=0,G=0,d=null;const pe=70,ge=.35,J=60,he=24,me=1.35,be=16;Ie(()=>((async()=>{var s,l;Xe(H,2);const e=new Set,r=o=>{o&&o.type==="image"&&o.value&&e.add(o.value)};c.backgrounds.forEach(r),(s=c.backgroundsMobile)==null||s.forEach(r),(l=c.subPageSections)==null||l.forEach(o=>{r(o.background),r(o.backgroundMobile)}),n(p).filter(o=>o.background&&o.background.type==="image").map(o=>o.background.value).forEach(o=>e.add(o));try{await Ue(Array.from(e)),ie.updateTaskStatus(H,"loaded"),console.log(`All assets for project '${c.slug}' preloaded successfully.`)}catch(o){console.error(o),ie.updateTaskStatus(H,"error",o.message)}finally{T.set(!0)}})(),()=>{h=!0,u==null||u.kill(),u=null,window.removeEventListener("wheel",Q),window.removeEventListener("keydown",ee),M.forEach(e=>{e==null||e.kill()}),w.forEach(e=>{e==null||e.kill()})}));async function ve(){if(h||(await We(),h))return;_=n(p).map(a=>document.getElementById(a.id));const t=k(He).url.hash,e=t.startsWith("#")?t.substring(1):null;let r=0;if(e){const a=n(p).findIndex(s=>s.id===e);a!==-1&&(r=a)}b=r,N(R,r),_.forEach((a,s)=>{const l=S.timeline({paused:!0}),o=a.querySelector(".subpage-content-overlay"),i=a.querySelector("h2"),m=a.querySelector("p");o&&l.fromTo(o,{autoAlpha:0,scale:.95},{autoAlpha:1,scale:1,duration:.7,ease:"power2.out"},"start"),i&&l.fromTo(i,{autoAlpha:0,y:30},{autoAlpha:1,y:0,duration:.8,ease:"power2.out"},"start+=0.2"),m&&l.fromTo(m,{autoAlpha:0,y:20},{autoAlpha:1,y:0,duration:.7,ease:"power2.out"},"start+=0.35"),M[s]=l;const y=a.querySelector(".subpage-background-image");y&&(w[s]=S.to(y,{scale:1.05,duration:3,ease:"power1.out",paused:!0}))}),_.forEach((a,s)=>{var l,o;s===r?(S.set(a,{yPercent:0,autoAlpha:1}),(l=M[s])==null||l.restart(),(o=w[s])==null||o.restart()):S.set(a,{yPercent:100,autoAlpha:0})}),h||(window.addEventListener("wheel",Q,{passive:!1}),window.addEventListener("keydown",ee))}function ye(t){if(!k(Y).isMobile||!k(T)||g)return;const e=t.changedTouches[0];e&&(X=e.clientY,U=e.clientX,G=performance.now(),d=null)}function ke(t){if(!k(Y).isMobile||!k(T)||g)return;const e=t.changedTouches[0];if(!e)return;const r=e.clientY,a=e.clientX,s=r-X,l=a-U,o=Math.abs(s),i=Math.abs(l);if(i>J){d=null;return}const m=o>i*me;!d&&o>=he&&m&&(d=s<0?"next":"prev");const y=document.scrollingElement??document.body,D=y?y.scrollTop<=0:window.scrollY<=0;s>0&&D&&m&&(o>=be||d==="prev")&&t.preventDefault()}function _e(t){if(!k(Y).isMobile||!k(T)||g){d=null;return}const e=t.changedTouches[0];if(!e){d=null;return}const r=e.clientY-X,a=e.clientX-U,s=Math.max(1,performance.now()-G);if(Math.abs(a)>J){d=null;return}const l=Math.abs(r)/s;if(Math.abs(r)>pe||l>ge){const o=d==="next"?1:d==="prev"?-1:r<0?1:-1;C(b+o)}d=null}function C(t){var l,o;if(h)return;const e=b;if(g||t===e||t<0||t>=_.length)return;g=!0,N(R,t);const r=_[e],a=_[t],s=t>e?1:-1;(l=M[e])==null||l.progress(0).pause(),(o=w[e])==null||o.progress(0).pause(),S.set(a,{yPercent:s*100,autoAlpha:1}),u==null||u.kill(),u=S.timeline({onComplete:()=>{h||(g=!1,b=t,u=null)}}),u.to(r,{yPercent:-s*100,autoAlpha:0,duration:x,ease:"expo.out"},"slide"),u.to(a,{yPercent:0,duration:x,ease:"expo.out"},"slide"),u.call(()=>{var i;h||(i=M[t])==null||i.restart()},[],`slide+=${x*.3}`),u.call(()=>{var i;h||(i=w[t])==null||i.restart()},[],`slide+=${x*.1}`)}function Q(t){t.preventDefault();const e=Date.now();e-I<F||g||(I=e,C(b+(t.deltaY>0?1:-1)))}function ee(t){if(g){t.preventDefault();return}const e=Date.now();if(e-I<F){t.preventDefault();return}let r=b,a=!1;switch(t.key){case"ArrowDown":case"PageDown":case" ":r++,a=!0;break;case"ArrowUp":case"PageUp":r--,a=!0;break;case"Home":r=0,a=!0;break;case"End":r=n(p).length-1,a=!0;break}a&&r!==b&&(t.preventDefault(),I=e,C(r))}se(()=>(A(),n(p)),()=>{const e=A().isMobile&&Array.isArray(c.backgroundsMobile)&&c.backgroundsMobile.length>0?c.backgroundsMobile:c.backgrounds,r=(e==null?void 0:e[0])??c.backgrounds[0];N(p,[{id:"overview",title:c.headline,content:c.summary,background:r},...(c.subPageSections??[]).map(a=>({...a,background:A().isMobile&&a.backgroundMobile?a.backgroundMobile:a.background}))]),N($,n(p).map(a=>({id:a.id,label:a.title})))}),se(()=>B(),()=>{B()&&ve()}),xe(),we();var te=Fe();Ce(t=>{var e=Ke();j(()=>{Oe.title=`${f(()=>c.headline)??""} | ${Ye(ue),f(()=>ue.author)??""}`,ce(e,"content",f(()=>c.summary))}),L(t,e)});var v=je(te);let ae;qe(v,7,()=>n(p),t=>t.id,(t,e)=>{var r=ze(),a=O(r);{var s=D=>{var oe=Ve();j(()=>Pe(oe,`background-image: url(${n(e),f(()=>n(e).background.value)??""});`)),L(D,oe)};le(a,D=>{n(e),f(()=>n(e).background)&&D(s)})}var l=V(a,2),o=O(l),i=O(o,!0);P(o);var m=V(o,2),y=O(m,!0);P(m),P(l),P(r),j(()=>{ce(r,"id",(n(e),f(()=>n(e).id))),ne(i,(n(e),f(()=>n(e).title))),ne(y,(n(e),f(()=>n(e).content)))}),L(t,r)}),P(v);var Se=V(v,2);{var Ee=t=>{Re(t,{get sections(){return n($)},get activeIndex(){return n(R)},$$events:{select:({detail:e})=>C(e.index)}})};le(Se,t=>{n($),f(()=>n($).length>1)&&t(Ee)})}j(t=>ae=De(v,1,"subpage-container svelte-gygcht",null,ae,t),[()=>({loaded:B()})]),Z("touchstart",v,ye,void 0,!0),Z("touchmove",v,ke),Z("touchend",v,_e,void 0,!0),L(q,te),Le(),de()}export{ft as component,dt as universal};
