var q=Object.defineProperty;var U=(h,l,c)=>l in h?q(h,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):h[l]=c;var r=(h,l,c)=>U(h,typeof l!="symbol"?l+"":l,c);import{s as B,a as H}from"./DY8pyCGo.js";import{i as K,a as W,s as X}from"./Cqwhy9oZ.js";import{p as j,O as L,r as g,G as n,o as z,ai as J,m as P,b as Q,c as O,a as V,a5 as b,f as Y,ap as A,n as Z,aq as I,am as tt}from"./DQxZm1d5.js";import{i as et}from"./CAJOqlX4.js";import{b as st}from"./B50fa6Xh.js";import{i as f,o as it,l as M,m as at}from"./D0H63XxL.js";import{p as rt}from"./BK-BTj-N.js";var ot=Y('<div><div class="loading-content svelte-1p9h290"><div class="word svelte-1p9h290"></div> <div class="scanline-overlay svelte-1p9h290"></div></div></div>');function ft(h,l){j(l,!1);const c=()=>B(rt,"$page",w),[w,G]=H();let p=L(!g(f)),m=L(!1),u=L(),s=null,v,y=!1;const _=800,S=200;let D=Date.now(),T;g(M);class C{constructor(t,e){r(this,"done",!1);r(this,"cycleCount",5);r(this,"cycleCurrent",0);r(this,"chars",["日","〇","ハ","ミ","ヒ","ウ","シ","ナ","モ","サ","ワ","ツ","オ","リ","ア","ホ","テ","マ","ケ","メ","エ","カ","キ","ム","ユ","ラ","セ","ネ","ヲ","イ","ク","コ","ソ","タ","チ","ト","ノ","フ","ヘ","ヤ","ヨ","ル","レ","ロ","∆","δ","ε","ζ","η","θ","∃","∄","∅","Д"]);r(this,"charsCount",this.chars.length);r(this,"letters",[]);r(this,"letterCount",0);r(this,"letterCurrent",0);r(this,"animationFrameId",null);r(this,"isRunning",!1);r(this,"originalText");r(this,"continuousMode",!1);r(this,"overlayTimeouts",new Map);r(this,"loop",()=>{if(this.continuousMode)this.letters.forEach(t=>{const e=t.getAttribute("data-orig");!e||e===" "||Math.random()<.1&&this.triggerOverlayGlitch(t)});else if(this.letters.forEach((t,e)=>{e>=this.letterCurrent&&t.getAttribute("data-orig")!==" "&&(t.dataset.char=this.getChar(),t.style.opacity=String(Math.random()))}),this.cycleCurrent<this.cycleCount)this.cycleCurrent++;else if(this.letterCurrent<this.letterCount){const t=this.letters[this.letterCurrent];this.cycleCurrent=0,this.resolveLetter(t),this.letterCurrent++}else this.done=!0,this.continuousMode=!0,this.done=!1;this.done||(this.animationFrameId=requestAnimationFrame(this.loop))});this.originalText=e,this.setupLetters(t)}setupLetters(t){t.innerHTML="",this.letters=[];for(let e=0;e<this.originalText.length;e++){const i=document.createElement("span"),o=this.originalText[e];i.setAttribute("data-orig",o),i.textContent=o===" "?" ":o,i.classList.add("glitching"),t.appendChild(i),this.letters.push(i)}this.letterCount=this.letters.length}getChar(){return this.chars[Math.floor(Math.random()*this.charsCount)]}start(){this.isRunning||(this.done=!1,this.isRunning=!0,this.loop())}destroy(){this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.overlayTimeouts.forEach(t=>clearTimeout(t)),this.overlayTimeouts.clear(),this.done=!0,this.isRunning=!1}resolveLetter(t){this.clearOverlay(t),t.style.opacity="1",t.style.transform="translateX(0) scale(1)",t.classList.remove("glitching"),t.classList.add("done")}triggerOverlayGlitch(t){this.clearOverlay(t),t.dataset.char=this.getChar(),t.classList.add("glitching"),t.style.opacity=String(.5+Math.random()*.5);const e=window.setTimeout(()=>{this.clearOverlay(t)},100+Math.random()*200);this.overlayTimeouts.set(t,e)}clearOverlay(t){const e=this.overlayTimeouts.get(t);e!==void 0&&(clearTimeout(e),this.overlayTimeouts.delete(t)),t.removeAttribute("data-char"),t.classList.remove("glitching"),t.style.opacity="1"}}function x(){if(n(m))return;const a=Date.now()-D,t=Math.max(0,at-a);T=setTimeout(()=>{y||(s&&(s.destroy(),s=null),b(m,!0),clearTimeout(v),v=window.setTimeout(()=>{y||b(p,!1)},_+S))},t)}const R=f.subscribe(a=>{a&&n(p)&&!n(m)&&x()}),k=it.subscribe(a=>{var t,e,i,o;if(!g(f)&&a==="error"&&n(u)){clearTimeout(T),s&&(s.destroy(),s=null);const d=((o=(i=(e=(t=c().data)==null?void 0:t.messages)==null?void 0:e.common)==null?void 0:i.loading)==null?void 0:o.error)??"ERROR LOADING";s=new C(n(u),d),s.start()}}),F=M.subscribe(a=>{var e,i,o,d;if(!n(u)||n(m))return;let t="LOADING...";switch(a){case"detecting":t="DETECTING LANGUAGE...";break;case"found-cookie":t="WELCOME BACK...";break;case"detected":t="LANGUAGE DETECTED...";break;case"error":t="REDIRECTING...";break;default:t=((d=(o=(i=(e=c().data)==null?void 0:e.messages)==null?void 0:i.common)==null?void 0:o.loading)==null?void 0:d.loading)??"LOADING..."}s&&a!=="idle"&&(s.destroy(),s=null,s=new C(n(u),t),s.start())});z(()=>{var a,t,e,i;if(D=Date.now(),!g(f)&&n(u)){const o=((i=(e=(t=(a=c().data)==null?void 0:a.messages)==null?void 0:t.common)==null?void 0:e.loading)==null?void 0:i.loading)??"LOADING...";s=new C(n(u),o),s.start()}}),J(()=>{y=!0,s&&(s.destroy(),s=null),clearTimeout(T),clearTimeout(v),k(),R(),F()}),K();var E=P(),N=Q(E);{var $=a=>{var t=ot();let e;W(t,"--fade-duration: 800ms;");var i=A(t),o=A(i);st(o,d=>b(u,d),()=>n(u)),Z(2),I(i),I(t),tt(d=>e=X(t,1,"loading-overlay svelte-1p9h290",null,e,d),[()=>({"fade-out":n(m)})]),O(a,t)};et(N,a=>{n(p)&&a($)})}O(h,E),V(),G()}export{ft as L};
